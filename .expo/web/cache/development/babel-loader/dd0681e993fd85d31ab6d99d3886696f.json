{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _base = require(\"../base\");\n\nvar _InternalAnimatedValue = _interopRequireDefault(require(\"../core/InternalAnimatedValue\"));\n\nvar MAX_STEPS_MS = 64;\n\nfunction spring(clock, state, config) {\n  var lastTime = (0, _base.cond)(state.time, state.time, clock);\n  var deltaTime = (0, _base.min)((0, _base.sub)(clock, lastTime), MAX_STEPS_MS);\n  var c = config.damping;\n  var m = config.mass;\n  var k = config.stiffness;\n  var v0 = (0, _base.multiply)(-1, state.velocity);\n  var x0 = (0, _base.sub)(config.toValue, state.position);\n  var zeta = (0, _base.divide)(c, (0, _base.multiply)(2, (0, _base.sqrt)((0, _base.multiply)(k, m))));\n  var omega0 = (0, _base.sqrt)((0, _base.divide)(k, m));\n  var omega1 = (0, _base.multiply)(omega0, (0, _base.sqrt)((0, _base.sub)(1, (0, _base.multiply)(zeta, zeta))));\n  var t = (0, _base.divide)(deltaTime, 1000);\n  var sin1 = (0, _base.sin)((0, _base.multiply)(omega1, t));\n  var cos1 = (0, _base.cos)((0, _base.multiply)(omega1, t));\n  var underDampedEnvelope = (0, _base.exp)((0, _base.multiply)(-1, zeta, omega0, t));\n  var underDampedFrag1 = (0, _base.multiply)(underDampedEnvelope, (0, _base.add)((0, _base.multiply)(sin1, (0, _base.divide)((0, _base.add)(v0, (0, _base.multiply)(zeta, omega0, x0)), omega1)), (0, _base.multiply)(x0, cos1)));\n  var underDampedPosition = (0, _base.sub)(config.toValue, underDampedFrag1);\n  var underDampedVelocity = (0, _base.sub)((0, _base.multiply)(zeta, omega0, underDampedFrag1), (0, _base.multiply)(underDampedEnvelope, (0, _base.sub)((0, _base.multiply)(cos1, (0, _base.add)(v0, (0, _base.multiply)(zeta, omega0, x0))), (0, _base.multiply)(omega1, x0, sin1))));\n  var criticallyDampedEnvelope = (0, _base.exp)((0, _base.multiply)(-1, omega0, t));\n  var criticallyDampedPosition = (0, _base.sub)(config.toValue, (0, _base.multiply)(criticallyDampedEnvelope, (0, _base.add)(x0, (0, _base.multiply)((0, _base.add)(v0, (0, _base.multiply)(omega0, x0)), t))));\n  var criticallyDampedVelocity = (0, _base.multiply)(criticallyDampedEnvelope, (0, _base.add)((0, _base.multiply)(v0, (0, _base.sub)((0, _base.multiply)(t, omega0), 1)), (0, _base.multiply)(t, x0, omega0, omega0)));\n  var prevPosition = state.prevPosition ? state.prevPosition : new _InternalAnimatedValue.default(0);\n  var isOvershooting = (0, _base.cond)((0, _base.and)(config.overshootClamping, (0, _base.neq)(config.stiffness, 0)), (0, _base.cond)((0, _base.lessThan)(prevPosition, config.toValue), (0, _base.greaterThan)(state.position, config.toValue), (0, _base.lessThan)(state.position, config.toValue)));\n  var isVelocity = (0, _base.lessThan)((0, _base.abs)(state.velocity), config.restSpeedThreshold);\n  var isDisplacement = (0, _base.or)((0, _base.eq)(config.stiffness, 0), (0, _base.lessThan)((0, _base.abs)((0, _base.sub)(config.toValue, state.position)), config.restDisplacementThreshold));\n  return (0, _base.block)([(0, _base.set)(prevPosition, state.position), (0, _base.cond)((0, _base.lessThan)(zeta, 1), [(0, _base.set)(state.position, underDampedPosition), (0, _base.set)(state.velocity, underDampedVelocity)], [(0, _base.set)(state.position, criticallyDampedPosition), (0, _base.set)(state.velocity, criticallyDampedVelocity)]), (0, _base.set)(state.time, clock), (0, _base.cond)((0, _base.or)(isOvershooting, (0, _base.and)(isVelocity, isDisplacement)), [(0, _base.cond)((0, _base.neq)(config.stiffness, 0), [(0, _base.set)(state.velocity, 0), (0, _base.set)(state.position, config.toValue)]), (0, _base.set)(state.finished, 1)])]);\n}\n\nvar procSpring = (0, _base.proc)(function (finished, velocity, position, time, prevPosition, toValue, damping, mass, stiffness, overshootClamping, restSpeedThreshold, restDisplacementThreshold, clock) {\n  return spring(clock, {\n    finished: finished,\n    velocity: velocity,\n    position: position,\n    time: time,\n    prevPosition: prevPosition\n  }, {\n    toValue: toValue,\n    damping: damping,\n    mass: mass,\n    stiffness: stiffness,\n    overshootClamping: overshootClamping,\n    restDisplacementThreshold: restDisplacementThreshold,\n    restSpeedThreshold: restSpeedThreshold\n  });\n});\n\nvar _default = function _default(clock, _ref, _ref2) {\n  var finished = _ref.finished,\n      velocity = _ref.velocity,\n      position = _ref.position,\n      time = _ref.time,\n      prevPosition = _ref.prevPosition;\n  var toValue = _ref2.toValue,\n      damping = _ref2.damping,\n      mass = _ref2.mass,\n      stiffness = _ref2.stiffness,\n      overshootClamping = _ref2.overshootClamping,\n      restDisplacementThreshold = _ref2.restDisplacementThreshold,\n      restSpeedThreshold = _ref2.restSpeedThreshold;\n  return procSpring(finished, velocity, position, time, prevPosition, toValue, damping, mass, stiffness, overshootClamping, restSpeedThreshold, restDisplacementThreshold, clock);\n};\n\nexports.default = _default;","map":{"version":3,"sources":["D:/Programming/React Native/drinkUp/node_modules/react-native-reanimated/src/animations/spring.js"],"names":["MAX_STEPS_MS","spring","clock","state","config","lastTime","time","deltaTime","c","damping","m","mass","k","stiffness","v0","velocity","x0","toValue","position","zeta","omega0","omega1","t","sin1","cos1","underDampedEnvelope","underDampedFrag1","underDampedPosition","underDampedVelocity","criticallyDampedEnvelope","criticallyDampedPosition","criticallyDampedVelocity","prevPosition","AnimatedValue","isOvershooting","overshootClamping","isVelocity","restSpeedThreshold","isDisplacement","restDisplacementThreshold","finished","procSpring"],"mappings":"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","sourcesContent":["import {\n  cond,\n  sub,\n  divide,\n  multiply,\n  sqrt,\n  add,\n  block,\n  set,\n  exp,\n  sin,\n  cos,\n  eq,\n  or,\n  neq,\n  and,\n  lessThan,\n  greaterThan,\n  proc,\n  min,\n  abs,\n} from '../base';\nimport AnimatedValue from '../core/InternalAnimatedValue';\n\nconst MAX_STEPS_MS = 64;\n\nfunction spring(clock, state, config) {\n  const lastTime = cond(state.time, state.time, clock);\n\n  const deltaTime = min(sub(clock, lastTime), MAX_STEPS_MS);\n\n  const c = config.damping;\n  const m = config.mass;\n  const k = config.stiffness;\n\n  const v0 = multiply(-1, state.velocity);\n  const x0 = sub(config.toValue, state.position);\n\n  const zeta = divide(c, multiply(2, sqrt(multiply(k, m)))); // damping ratio\n  const omega0 = sqrt(divide(k, m)); // undamped angular frequency of the oscillator (rad/ms)\n  const omega1 = multiply(omega0, sqrt(sub(1, multiply(zeta, zeta)))); // exponential decay\n\n  const t = divide(deltaTime, 1000); // in seconds\n\n  const sin1 = sin(multiply(omega1, t));\n  const cos1 = cos(multiply(omega1, t));\n\n  // under damped\n  const underDampedEnvelope = exp(multiply(-1, zeta, omega0, t));\n  const underDampedFrag1 = multiply(\n    underDampedEnvelope,\n    add(\n      multiply(sin1, divide(add(v0, multiply(zeta, omega0, x0)), omega1)),\n      multiply(x0, cos1)\n    )\n  );\n  const underDampedPosition = sub(config.toValue, underDampedFrag1);\n  // This looks crazy -- it's actually just the derivative of the oscillation function\n  const underDampedVelocity = sub(\n    multiply(zeta, omega0, underDampedFrag1),\n    multiply(\n      underDampedEnvelope,\n      sub(\n        multiply(cos1, add(v0, multiply(zeta, omega0, x0))),\n        multiply(omega1, x0, sin1)\n      )\n    )\n  );\n\n  // critically damped\n  const criticallyDampedEnvelope = exp(multiply(-1, omega0, t));\n  const criticallyDampedPosition = sub(\n    config.toValue,\n    multiply(\n      criticallyDampedEnvelope,\n      add(x0, multiply(add(v0, multiply(omega0, x0)), t))\n    )\n  );\n  const criticallyDampedVelocity = multiply(\n    criticallyDampedEnvelope,\n    add(\n      multiply(v0, sub(multiply(t, omega0), 1)),\n      multiply(t, x0, omega0, omega0)\n    )\n  );\n\n  // conditions for stopping the spring animations\n  const prevPosition = state.prevPosition\n    ? state.prevPosition\n    : new AnimatedValue(0);\n\n  const isOvershooting = cond(\n    and(config.overshootClamping, neq(config.stiffness, 0)),\n    cond(\n      lessThan(prevPosition, config.toValue),\n      greaterThan(state.position, config.toValue),\n      lessThan(state.position, config.toValue)\n    )\n  );\n  const isVelocity = lessThan(abs(state.velocity), config.restSpeedThreshold);\n  const isDisplacement = or(\n    eq(config.stiffness, 0),\n    lessThan(\n      abs(sub(config.toValue, state.position)),\n      config.restDisplacementThreshold\n    )\n  );\n\n  return block([\n    set(prevPosition, state.position),\n    cond(\n      lessThan(zeta, 1),\n      [\n        set(state.position, underDampedPosition),\n        set(state.velocity, underDampedVelocity),\n      ],\n      [\n        set(state.position, criticallyDampedPosition),\n        set(state.velocity, criticallyDampedVelocity),\n      ]\n    ),\n    set(state.time, clock),\n    cond(or(isOvershooting, and(isVelocity, isDisplacement)), [\n      cond(neq(config.stiffness, 0), [\n        set(state.velocity, 0),\n        set(state.position, config.toValue),\n      ]),\n      set(state.finished, 1),\n    ]),\n  ]);\n}\n\nconst procSpring = proc(\n  (\n    finished,\n    velocity,\n    position,\n    time,\n    prevPosition,\n    toValue,\n    damping,\n    mass,\n    stiffness,\n    overshootClamping,\n    restSpeedThreshold,\n    restDisplacementThreshold,\n    clock\n  ) =>\n    spring(\n      clock,\n      {\n        finished,\n        velocity,\n        position,\n        time,\n        // @ts-ignore\n        prevPosition,\n      },\n      {\n        toValue,\n        damping,\n        mass,\n        stiffness,\n        overshootClamping,\n        restDisplacementThreshold,\n        restSpeedThreshold,\n      }\n    )\n);\n\nexport default (\n  clock,\n  {\n    finished,\n    velocity,\n    position,\n    time,\n    // @ts-ignore\n    prevPosition,\n  },\n  {\n    toValue,\n    damping,\n    mass,\n    stiffness,\n    overshootClamping,\n    restDisplacementThreshold,\n    restSpeedThreshold,\n  }\n) =>\n  procSpring(\n    finished,\n    velocity,\n    position,\n    time,\n    prevPosition,\n    toValue,\n    damping,\n    mass,\n    stiffness,\n    overshootClamping,\n    restSpeedThreshold,\n    restDisplacementThreshold,\n    clock\n  );\n"]},"metadata":{},"sourceType":"script"}